<!DOCTYPE html>
<html lang="en-us">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <meta itemprop="name" content="Bo Jeanes" />
  <meta itemprop="description" content="" />

  <link rel="apple-touch-icon" sizes="180x180" href="https://bjeanes.com/apple-touch-icon.png"/>
  <link rel="icon" type="image/png" sizes="32x32" href="https://bjeanes.com/favicon-32x32.png" />
  <link
    rel="icon"
    type="image/png"
    sizes="16x16"
    href="https://bjeanes.com/favicon-16x16.png"
  />
  <link
    rel="shortcut icon"
    href="https://bjeanes.com/favicon.ico"
  />
  <link rel="stylesheet" href="https://bjeanes.com/style.css"/>
  
  <title>64-bit Postgres and Rails on Snow Leopard </title>
  

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://bjeanes.com/atom.xml">
  

  <body id="page">

	
<header id="site-header" class="animated slideInUp faster">
  <div class="hdr-wrapper section-inner">
    <div class="hdr-left">
      <div class="site-branding">
        <a href="https:&#x2F;&#x2F;bjeanes.com">Bo Jeanes</a>
      </div>
      <nav class="site-nav hide-in-mobile">
            
        
        <a href="https://bjeanes.com/posts">Posts</a>
        
        <a href="https://bjeanes.com/about">About</a>
        
      </nav>
    </div>
    <div class="hdr-right hdr-icons">
      <span class="hdr-social hide-in-mobile">
        

<a href="https:&#x2F;&#x2F;github.com&#x2F;bjeanes" target="_blank" rel="noopener me"
   title="github">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
  
</a>

<a href="https:&#x2F;&#x2F;gitlab.com&#x2F;bjeanes" target="_blank" rel="noopener me"
   title="gitlab">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 0 1 4.82 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0 1 18.6 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.51L23 13.45a.84.84 0 0 1-.35.94z"></path></svg>
  
</a>

<a href="https:&#x2F;&#x2F;twitter.com&#x2F;bjeanes" target="_blank" rel="noopener me"
   title="twitter">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
  
</a>

<a href="https:&#x2F;&#x2F;instagram.com&#x2F;bjeanes" target="_blank" rel="noopener me"
   title="instagram">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line></svg>
  
</a>

<a href="https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;bjeanes&#x2F;" target="_blank" rel="noopener me"
   title="linkedin">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
  
</a>

<a href="mailto:me@bjeanes.com" target="_blank" rel="noopener me"
   title="email">
  
  <svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
  
</a>


      </span>
      <button id="menu-btn" class="hdr-btn" title="Menu">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="feather feather-menu"
        >
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>
</header>
<div id="mobile-menu" class="animated fast">
  <ul>
    
    <li><a href="https://bjeanes.com/posts">Posts</a></li>
    
    <li><a href="https://bjeanes.com/about">About</a></li>
    
  </ul>
</div>

	
	

		
<main class="site-main section-inner animated fadeIn faster">
  <article class="thin">
	<header class="post-header">
	  <div class="post-meta">
		
		<span>Nov 03, 2009</span>
		<small> - 
<span class="reading-time" title="Estimated read time">
  
  1 min read
  
</span>
</small>
		
            
	  </div>
	  <h1>64-bit Postgres and Rails on Snow Leopard </h1>
	</header>

	<div class="content">
        
	  <h3 id="dependencies">Dependencies</h3>
<p>Install the GEOS and PROJ frameworks from
<a href="http://www.kyngchaos.com/software:frameworks">here</a></p>
<h3 id="postgres">Postgres</h3>
<h4 id="download-and-compile">Download and Compile</h4>
<pre data-lang="bash" style="background-color:#282c34;color:#dcdfe4;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#e06c75;">http://ftp2.au.postgresql.org/pub/postgresql/source/v8.4.1/postgresql-8.4.1.tar.bz2 </span><span style="color:#c678dd;">| </span><span style="color:#e06c75;">tar</span><span> xjf -
</span><span style="color:#61afef;">cd</span><span> postgresql-8.4.1
</span><span style="color:#e06c75;">./configure
</span><span style="color:#e06c75;">make </span><span style="color:#c678dd;">&amp;&amp; </span><span style="color:#e06c75;">sudo</span><span> make install
</span></code></pre>
<p>The files are now all installed in the right places, onwards to making
them usable!</p>
<h4 id="create-a-postgres-user-and-group">Create a <code>postgres</code> User and Group</h4>
<p>This is adjusted from the instructions in the comments
<a href="http://www.postgresql.org/docs/8.3/interactive/postgres-user.html">here</a>).</p>
<pre data-lang="bash" style="background-color:#282c34;color:#dcdfe4;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#5c6370;"># Find unused Group ID and User ID:
</span><span style="color:#c678dd;">export </span><span style="color:#e06c75;">GROUPID</span><span style="color:#c678dd;">=</span><span>`</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -list</span><span> /Groups PrimaryGroupID </span><span style="color:#c678dd;">| </span><span style="color:#e06c75;">ruby -e </span><span style="color:#98c379;">&#39;puts STDIN.read.scan(/\d+/m).map{|i|i.to_i}.uniq.sort.last.succ&#39;</span><span>`
</span><span style="color:#c678dd;">export </span><span style="color:#e06c75;">USERID</span><span style="color:#c678dd;">=</span><span>`</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -list</span><span> /Users UniqueID </span><span style="color:#c678dd;">| </span><span style="color:#e06c75;">ruby -e </span><span style="color:#98c379;">&#39;puts STDIN.read.scan(/\d+/m).map{|i|i.to_i}.uniq.sort.last.succ&#39;</span><span>`
</span><span>
</span><span style="color:#5c6370;"># Create group:
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Groups/_postgres
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Groups/_postgres PrimaryGroupID $</span><span style="color:#e06c75;">GROUPID
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -append</span><span> /Groups/_postgres RecordName postgres
</span><span>
</span><span style="color:#5c6370;"># Create user:
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Users/_postgres
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Users/_postgres UniqueID $</span><span style="color:#e06c75;">USERID
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Users/_postgres PrimaryGroupID $</span><span style="color:#e06c75;">GROUPID
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Users/_postgres UserShell /bin/bash
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Users/_postgres RealName </span><span style="color:#98c379;">&quot;PostgreSQL Server&quot;
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -create</span><span> /Users/_postgres NFSHomeDirectory /usr/local/pgsql
</span><span style="color:#e06c75;">sudo</span><span> dscl .</span><span style="color:#e06c75;"> -append</span><span> /Users/_postgres RecordName postgres
</span></code></pre>
<p>That’s the clean way of making a user (so it doesn’t show up in your
Accounts preference pane, etc.</p>
<h4 id="clean-up">Clean up</h4>
<pre data-lang="bash" style="background-color:#282c34;color:#dcdfe4;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#e06c75;">sudo</span><span> touch /var/log/psql.log
</span><span style="color:#e06c75;">sudo</span><span> mkdir /usr/local/pgsql/data
</span><span style="color:#e06c75;">sudo</span><span> chown</span><span style="color:#e06c75;"> -R</span><span> postgres:postgres /usr/local/pgsql/data /var/log/psql.log
</span><span>
</span><span style="color:#5c6370;"># Put Postgres in your path
</span><span style="color:#c678dd;">export </span><span style="color:#e06c75;">$PATH</span><span style="color:#c678dd;">=</span><span style="color:#98c379;">&quot;/usr/local/pgsql/bin:$</span><span style="color:#e06c75;">PATH</span><span style="color:#98c379;">&quot;
</span><span style="color:#e06c75;">sudo</span><span> sh</span><span style="color:#e06c75;"> -c </span><span style="color:#98c379;">&#39;echo /usr/local/pgsql/bin &gt; /etc/paths.d/pgsql&#39;
</span></code></pre>
<p>Thanks to Apple we have a nice way of setting the PATH across the entire
system so every app should now know how to find the Postgres binaries
and the data directory is now set up to store the database files — now,
we just need to create them.</p>
<h4 id="initialise-the-database">Initialise the Database</h4>
<pre data-lang="bash" style="background-color:#282c34;color:#dcdfe4;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#5c6370;"># Become the postgres user
</span><span style="color:#e06c75;">sudo</span><span> su - postgres
</span><span>
</span><span style="color:#5c6370;"># If this throws next commant throws an error about shared memory, 
</span><span style="color:#5c6370;"># try putting &quot;these lines&quot;:http://gist.github.com/224815 into 
</span><span style="color:#5c6370;"># /etc/sysctl.conf, rebooting, and trying again:
</span><span style="color:#e06c75;">initdb -D</span><span> /usr/local/pgsql/data</span><span style="color:#e06c75;"> -E</span><span> UTF8
</span><span>
</span><span style="color:#5c6370;"># Start the database
</span><span style="color:#e06c75;">postgres -D</span><span> /usr/local/pgsql/data </span><span style="color:#c678dd;">&gt;</span><span>/var/log/psql.log </span><span style="color:#e5c07b;">2</span><span style="color:#c678dd;">&gt;&amp;</span><span style="color:#e5c07b;">1 </span><span style="color:#c678dd;">&amp;
</span><span>
</span><span style="color:#5c6370;"># Create a test database and check you can connect to it
</span><span style="color:#e06c75;">createdb</span><span> test
</span><span style="color:#e06c75;">psql</span><span> test
</span><span>
</span><span style="color:#5c6370;"># Just create a superuser for general dev tasks
</span><span style="color:#e06c75;">createuser</span><span> postgres
</span><span>
</span><span style="color:#5c6370;"># we don&#39;t want to be the postgres user anymore
</span><span style="color:#61afef;">exit
</span></code></pre>
<p>Your done with the Postgres setup now!</p>
<h3 id="postgis">PostGIS</h3>
<pre data-lang="bash" style="background-color:#282c34;color:#dcdfe4;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#e06c75;">curl</span><span> http://postgis.refractions.net/download/postgis-1.3.7SVN.tar.gz </span><span style="color:#c678dd;">| </span><span style="color:#e06c75;">tar</span><span> xzf -
</span><span style="color:#61afef;">cd</span><span> postgis-1.3.7SVN
</span><span style="color:#e06c75;">./configure --with-geosconfig</span><span style="color:#c678dd;">=</span><span>/Library/Frameworks/GEOS.framework/unix/bin/geos-config</span><span style="color:#e06c75;"> --with-projdir</span><span style="color:#c678dd;">=</span><span>/Library/Frameworks/PROJ.framework/unix
</span><span style="color:#e06c75;">make </span><span style="color:#c678dd;">&amp;&amp; </span><span style="color:#e06c75;">sudo</span><span> make install
</span></code></pre>
<p>Phew! That one was easy.</p>
<h3 id="postgres-ruby-gem">Postgres Ruby Gem</h3>
<p>This is the part that everyone cares about the most. If this works your
Rails apps should start working like a charm.</p>
<pre data-lang="bash" style="background-color:#282c34;color:#dcdfe4;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#e06c75;">sudo</span><span> env ARCHFLAGS=</span><span style="color:#98c379;">&#39;-arch x86_64&#39;</span><span> gem install pg
</span></code></pre>

	</div>
	<hr class="post-end">
	<footer class="post-info">
    
    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>478 Words</p>
    
    <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2009-11-03T05:12:00Z</p>
    
	</footer>
  </article>
    
  
  <div class="post-nav thin">
	
	
  </div>

  
</main>

	  </div>
	  
	  



<footer id="site-footer" class="section-inner thin animated fadeIn faster">
  <p>&copy; 2022 <a href="https:&#x2F;&#x2F;bjeanes.com">Bo Jeanes</a></p>
  <p>Made with <a href="https://www.getzola.org" target="_blank" rel="noopener">Zola</a> &#183; Theme <a href="https://github.com/VersBinarii/hermit_zola" target="_blank" rel="noopener">Hermit_Zola</a>
	
	&#183; <a href="https://bjeanes.com/atom.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
	
  </p>
</footer>




	</div>
	
	<script src="https://bjeanes.com/js/main.js"></script>

	<!-- Math rendering -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
        onload="renderMathInElement(document.body, { delimiters: [ {left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}, {left: '\\[', right: '\\]', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>

    

	
	<script src="https://bjeanes.com/js/copy.js"></script>
	
	<script src="https://bjeanes.com/js/main.js"></script>

    
    

	
  </body>
</html>
